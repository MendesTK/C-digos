package com.mcdonalds.DAO;

import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
 
import java.sql.*;
 
import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
 
public class Main implements ActionListener
{
    // Declara componentes
 
    // Declara objetos de conexão
    private Connection conn;
    private Statement query;
 
 
    public static void criaGUI()
    {
        // Cria formulario
        JFrame formulario = new JFrame("MSSQL Express 2012");
        formulario.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
 
        // cria classe da conexão
        ConexaoMssql conectar = new ConexaoMssql();
 
        // Define painel
        formulario.setContentPane(conectar.criaPainel());
        formulario.pack();
 
        // Mostra aplicação
        formulario.setVisible(true);
    }
 
    public void conectar(String banco, String login, String senha) {
        try
        {
            // Define Driver de conexão JDBC thin
            String URL =  "jdbc:sqlserver://192.168.0.107:1433;" + "databaseName=" + banco +
                          ";user=" + login + ";password="+senha;
 
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            conn = DriverManager.getConnection(URL);                      
 
                    //Executa pedido SQL
            query = conn.createStatement();
            JOptionPane.showMessageDialog(menssagem, "Conexão Efetuada com sucesso!");
        } 
 
        catch (ClassNotFoundException ex)
        {
            ex.printStackTrace();
        }
 
        catch (SQLException ex)
        {
            JOptionPane.showMessageDialog(menssagem, "Erro na conexão!");
            ex.printStackTrace();
        }
    }
 
    public void actionPerformed(ActionEvent arg0)
    {
       // Verfica tamanho da senha
        char[] tamanho = tsenha.getPassword();
 
        if (tamanho.length == 0)
 
        {
            JOptionPane.showMessageDialog(menssagem, "Digite uma senha!");
        }
        else
        {
            // recupera senha do Java Password Field
            String psenha = new String(tsenha.getPassword());
 
            //Cria conexão
            ConexaoMssql conecta= new ConexaoMssql();
            conecta.conectar(tbanco.getText(), tusuario.getText() , psenha);
 
        }
 
    }
 
    public static void main(String[] args)
    {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
 
            public void run() {
 
                // Cria e exibe GUI
                criaGUI();
 
            }
        });      
 
    }
}